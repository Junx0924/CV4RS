[INFO:2021-01-09 02:19:12] Before parsing arguments
[INFO:2021-01-09 02:19:12] Before loading config
[INFO:2021-01-09 02:19:12] Mid loading config 1/2
[INFO:2021-01-09 02:19:12] Mid loading config 2/2
[INFO:2021-01-09 02:19:12] After loading config
[INFO:2021-01-09 02:19:12] Before train.start(config)
[INFO:2021-01-09 02:19:26] Before GPU mem reserve
[INFO:2021-01-09 02:19:26] Before mkdir
[INFO:2021-01-09 02:19:26] Before Logger init
[INFO:2021-01-09 02:19:26] {
    "backend": "faiss-gpu",
    "cuda_device": 0,
    "dataloader": {
        "batch_size": 128,
        "drop_last": false,
        "num_workers": 0,
        "pin_memory": true,
        "shuffle": false
    },
    "dataset": {
        "bigearth": {
            "classes": {
                "eval": "eval",
                "init": "init",
                "train": "train"
            },
            "root": "/scratch/CV4RS/Dataset/BigEarthNet"
        },
        "inshop": {
            "classes": {
                "eval": "range(0, 3985)",
                "init": "range(0, 3997)",
                "train": "range(0, 3997)"
            },
            "root": "/export/home/vtschern/data/in-shop"
        },
        "mlrsnet": {
            "classes": {
                "eval": "eval",
                "init": "init",
                "train": "train"
            },
            "root": "/scratch/CV4RS/Dataset/MLRSNet"
        },
        "sop": {
            "classes": {
                "eval": "range(11318, 22634)",
                "init": "range(0, 11318)",
                "train": "range(0, 11318)"
            },
            "root": "/Users/paulkaufmann/Downloads/CV4RS datasets/Stanford_Online_Products"
        },
        "vid": {
            "classes": {
                "_note": "small: 800, mid: +1600, large: +2400",
                "eval": "range(13164, 15564)",
                "init": "range(0, 13164)",
                "train": "range(0, 13164)"
            },
            "root": "/export/home/vtschern/data/vehicle-id/VehicleID_V1.0"
        }
    },
    "dataset_selected": "mlrsnet",
    "finetune_epoch": 190,
    "is_on_colab": false,
    "log": {
        "name": "mlrsnet-K-60-M-2-exp-0",
        "path": "/home/users/p/paka0401/CV4RS/CV4RS/2_metric-learning-divide-and-conquer/log/default"
    },
    "nb_clusters": 60,
    "nb_epochs": 200,
    "opt": {
        "backbone": {
            "lr": 1e-05,
            "weight_decay": 0.0001
        },
        "embedding": {
            "lr": 1e-05,
            "weight_decay": 0.0001
        }
    },
    "pretrained_weights_file": "/home/users/p/paka0401/CV4RS/CV4RS/2_metric-learning-divide-and-conquer/pretrained_weights/resnet50-19c8e357.pth",
    "random_seed": 0,
    "recluster": {
        "enabled": true,
        "mod_epoch": 2
    },
    "save_model": true,
    "sz_embedding": 4096,
    "transform_parameters": {
        "intensity_scale": [
            [
                0,
                1
            ],
            [
                0,
                1
            ]
        ],
        "mean": [
            0.485,
            0.456,
            0.406
        ],
        "rgb_to_bgr": false,
        "std": [
            0.229,
            0.224,
            0.225
        ],
        "sz_crop": 224
    },
    "verbose": false
}
[INFO:2021-01-09 02:20:54] Loading Dataset: MLRSNet (init); Processing 24964 labels
[INFO:2021-01-09 02:23:06]   Done loading.
[INFO:2021-01-09 02:23:06] Loading Dataset: MLRSNet (eval); Processing 4908 labels
[INFO:2021-01-09 02:23:28]   Done loading.
[INFO:2021-01-09 02:23:28] Evaluating initial model...
[INFO:2021-01-09 02:23:28]   Computing evaluation score..
[INFO:2021-01-09 02:37:34] R@1 : 0.338
[INFO:2021-01-09 02:37:34] R@2 : 2.371
[INFO:2021-01-09 02:37:34] R@4 : 11.367
[INFO:2021-01-09 02:37:34] R@8 : 42.317
[INFO:2021-01-09 02:37:34] Evaluation 2...
[INFO:2021-01-09 02:37:34]   Computing evaluation score..
[INFO:2021-01-09 03:40:06] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:42:08]   Done loading.
[INFO:2021-01-09 03:42:09] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:44:06]   Done loading.
[INFO:2021-01-09 03:44:07] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:46:03]   Done loading.
[INFO:2021-01-09 03:46:04] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:47:56]   Done loading.
[INFO:2021-01-09 03:47:57] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:49:51]   Done loading.
[INFO:2021-01-09 03:49:52] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:51:46]   Done loading.
[INFO:2021-01-09 03:51:47] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:53:36]   Done loading.
[INFO:2021-01-09 03:53:37] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:55:27]   Done loading.
[INFO:2021-01-09 03:55:28] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:57:16]   Done loading.
[INFO:2021-01-09 03:57:16] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 03:59:03]   Done loading.
[INFO:2021-01-09 03:59:03] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:00:49]   Done loading.
[INFO:2021-01-09 04:00:50] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:02:35]   Done loading.
[INFO:2021-01-09 04:02:36] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:04:21]   Done loading.
[INFO:2021-01-09 04:04:22] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:06:08]   Done loading.
[INFO:2021-01-09 04:06:08] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:07:53]   Done loading.
[INFO:2021-01-09 04:07:54] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:09:39]   Done loading.
[INFO:2021-01-09 04:09:39] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:11:25]   Done loading.
[INFO:2021-01-09 04:11:25] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:13:13]   Done loading.
[INFO:2021-01-09 04:13:13] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:15:11]   Done loading.
[INFO:2021-01-09 04:15:12] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:17:18]   Done loading.
[INFO:2021-01-09 04:17:18] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:19:28]   Done loading.
[INFO:2021-01-09 04:19:28] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:21:38]   Done loading.
[INFO:2021-01-09 04:21:38] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:23:54]   Done loading.
[INFO:2021-01-09 04:23:55] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:26:20]   Done loading.
[INFO:2021-01-09 04:26:20] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:28:42]   Done loading.
[INFO:2021-01-09 04:28:43] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:30:53]   Done loading.
[INFO:2021-01-09 04:30:54] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:32:45]   Done loading.
[INFO:2021-01-09 04:32:46] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:34:39]   Done loading.
[INFO:2021-01-09 04:34:39] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:36:35]   Done loading.
[INFO:2021-01-09 04:36:36] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:38:31]   Done loading.
[INFO:2021-01-09 04:38:31] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:40:25]   Done loading.
[INFO:2021-01-09 04:40:26] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:42:19]   Done loading.
[INFO:2021-01-09 04:42:20] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:44:11]   Done loading.
[INFO:2021-01-09 04:44:11] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:46:04]   Done loading.
[INFO:2021-01-09 04:46:04] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:47:55]   Done loading.
[INFO:2021-01-09 04:47:56] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:49:44]   Done loading.
[INFO:2021-01-09 04:49:44] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:51:41]   Done loading.
[INFO:2021-01-09 04:51:41] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:53:34]   Done loading.
[INFO:2021-01-09 04:53:34] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:55:23]   Done loading.
[INFO:2021-01-09 04:55:23] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:57:10]   Done loading.
[INFO:2021-01-09 04:57:11] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 04:59:18]   Done loading.
[INFO:2021-01-09 04:59:19] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:01:30]   Done loading.
[INFO:2021-01-09 05:01:31] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:03:40]   Done loading.
[INFO:2021-01-09 05:03:40] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:05:47]   Done loading.
[INFO:2021-01-09 05:05:48] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:07:53]   Done loading.
[INFO:2021-01-09 05:07:53] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:09:51]   Done loading.
[INFO:2021-01-09 05:09:52] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:11:41]   Done loading.
[INFO:2021-01-09 05:11:41] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:13:32]   Done loading.
[INFO:2021-01-09 05:13:32] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:15:20]   Done loading.
[INFO:2021-01-09 05:15:21] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:17:13]   Done loading.
[INFO:2021-01-09 05:17:13] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:19:08]   Done loading.
[INFO:2021-01-09 05:19:09] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:21:12]   Done loading.
[INFO:2021-01-09 05:21:12] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:23:23]   Done loading.
[INFO:2021-01-09 05:23:24] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:25:36]   Done loading.
[INFO:2021-01-09 05:25:37] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:27:45]   Done loading.
[INFO:2021-01-09 05:27:45] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:29:50]   Done loading.
[INFO:2021-01-09 05:29:51] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:32:06]   Done loading.
[INFO:2021-01-09 05:32:07] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:34:19]   Done loading.
[INFO:2021-01-09 05:34:20] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:36:30]   Done loading.
[INFO:2021-01-09 05:36:31] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 05:38:48]   Done loading.
[INFO:2021-01-09 05:38:48] Training for 200 epochs.
