[INFO:2021-01-09 12:11:37] Before parsing arguments
[INFO:2021-01-09 12:11:37] Before loading config
[INFO:2021-01-09 12:11:37] Mid loading config 1/2
[INFO:2021-01-09 12:11:37] Mid loading config 2/2
[INFO:2021-01-09 12:11:37] After loading config
[INFO:2021-01-09 12:11:37] Before train.start(config)
[INFO:2021-01-09 12:11:49] Before GPU mem reserve
[INFO:2021-01-09 12:11:49] Before mkdir
[INFO:2021-01-09 12:11:49] Before Logger init
[INFO:2021-01-09 12:11:49] {
    "backend": "faiss-gpu",
    "cuda_device": 0,
    "dataloader": {
        "batch_size": 128,
        "drop_last": false,
        "num_workers": 0,
        "pin_memory": true,
        "shuffle": false
    },
    "dataset": {
        "bigearth": {
            "classes": {
                "eval": "eval",
                "init": "init",
                "train": "train"
            },
            "root": "/scratch/CV4RS/Dataset/BigEarthNet"
        },
        "inshop": {
            "classes": {
                "eval": "range(0, 3985)",
                "init": "range(0, 3997)",
                "train": "range(0, 3997)"
            },
            "root": "/export/home/vtschern/data/in-shop"
        },
        "mlrsnet": {
            "classes": {
                "eval": "eval",
                "init": "init",
                "train": "train"
            },
            "root": "/scratch/CV4RS/Dataset/MLRSNet"
        },
        "sop": {
            "classes": {
                "eval": "range(11318, 22634)",
                "init": "range(0, 11318)",
                "train": "range(0, 11318)"
            },
            "root": "/Users/paulkaufmann/Downloads/CV4RS datasets/Stanford_Online_Products"
        },
        "vid": {
            "classes": {
                "_note": "small: 800, mid: +1600, large: +2400",
                "eval": "range(13164, 15564)",
                "init": "range(0, 13164)",
                "train": "range(0, 13164)"
            },
            "root": "/export/home/vtschern/data/vehicle-id/VehicleID_V1.0"
        }
    },
    "dataset_selected": "mlrsnet",
    "finetune_epoch": 190,
    "is_on_colab": false,
    "log": {
        "name": "mlrsnet-K-60-M-2-exp-0",
        "path": "/home/users/p/paka0401/CV4RS/CV4RS/2_metric-learning-divide-and-conquer/log/default"
    },
    "nb_clusters": 60,
    "nb_epochs": 200,
    "opt": {
        "backbone": {
            "lr": 1e-05,
            "weight_decay": 0.0001
        },
        "embedding": {
            "lr": 1e-05,
            "weight_decay": 0.0001
        }
    },
    "pretrained_weights_file": "/home/users/p/paka0401/CV4RS/CV4RS/2_metric-learning-divide-and-conquer/pretrained_weights/resnet50-19c8e357.pth",
    "random_seed": 0,
    "recluster": {
        "enabled": true,
        "mod_epoch": 2
    },
    "save_model": true,
    "sz_embedding": 4096,
    "transform_parameters": {
        "intensity_scale": [
            [
                0,
                1
            ],
            [
                0,
                1
            ]
        ],
        "mean": [
            0.485,
            0.456,
            0.406
        ],
        "rgb_to_bgr": false,
        "std": [
            0.229,
            0.224,
            0.225
        ],
        "sz_crop": 224
    },
    "verbose": false
}
[INFO:2021-01-09 12:12:57] Loading Dataset: MLRSNet (init); Processing 24964 labels
[INFO:2021-01-09 12:15:47]   Done loading.
[INFO:2021-01-09 12:15:48] Loading Dataset: MLRSNet (eval); Processing 4908 labels
[INFO:2021-01-09 12:16:12]   Done loading.
[INFO:2021-01-09 12:16:12] Evaluating initial model...
[INFO:2021-01-09 12:16:12]   Computing evaluation score..
[INFO:2021-01-09 12:32:14] R@1 : 0.338
[INFO:2021-01-09 12:32:14] R@2 : 2.371
[INFO:2021-01-09 12:32:14] R@4 : 11.367
[INFO:2021-01-09 12:32:14] R@8 : 42.317
[INFO:2021-01-09 12:32:14] Evaluation 2...
[INFO:2021-01-09 12:32:14]   Computing evaluation score..
[INFO:2021-01-09 13:44:03] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:45:52]   Done loading.
[INFO:2021-01-09 13:45:52] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:47:43]   Done loading.
[INFO:2021-01-09 13:47:43] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:49:35]   Done loading.
[INFO:2021-01-09 13:49:36] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:51:27]   Done loading.
[INFO:2021-01-09 13:51:28] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:53:19]   Done loading.
[INFO:2021-01-09 13:53:19] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:55:11]   Done loading.
[INFO:2021-01-09 13:55:11] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:57:03]   Done loading.
[INFO:2021-01-09 13:57:03] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 13:58:54]   Done loading.
[INFO:2021-01-09 13:58:55] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:00:46]   Done loading.
[INFO:2021-01-09 14:00:47] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:02:37]   Done loading.
[INFO:2021-01-09 14:02:38] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:04:28]   Done loading.
[INFO:2021-01-09 14:04:28] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:06:19]   Done loading.
[INFO:2021-01-09 14:06:20] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:08:09]   Done loading.
[INFO:2021-01-09 14:08:10] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:10:00]   Done loading.
[INFO:2021-01-09 14:10:01] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:11:51]   Done loading.
[INFO:2021-01-09 14:11:52] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:13:43]   Done loading.
[INFO:2021-01-09 14:13:44] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:15:33]   Done loading.
[INFO:2021-01-09 14:15:34] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:17:25]   Done loading.
[INFO:2021-01-09 14:17:25] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:19:15]   Done loading.
[INFO:2021-01-09 14:19:15] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:21:05]   Done loading.
[INFO:2021-01-09 14:21:06] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:22:56]   Done loading.
[INFO:2021-01-09 14:22:58] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:24:47]   Done loading.
[INFO:2021-01-09 14:24:48] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:26:38]   Done loading.
[INFO:2021-01-09 14:26:38] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:28:28]   Done loading.
[INFO:2021-01-09 14:28:29] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:30:18]   Done loading.
[INFO:2021-01-09 14:30:19] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:32:09]   Done loading.
[INFO:2021-01-09 14:32:10] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:34:01]   Done loading.
[INFO:2021-01-09 14:34:02] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:35:51]   Done loading.
[INFO:2021-01-09 14:35:52] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:37:42]   Done loading.
[INFO:2021-01-09 14:37:43] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:39:33]   Done loading.
[INFO:2021-01-09 14:39:34] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:41:24]   Done loading.
[INFO:2021-01-09 14:41:25] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:43:14]   Done loading.
[INFO:2021-01-09 14:43:15] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:45:04]   Done loading.
[INFO:2021-01-09 14:45:05] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:46:54]   Done loading.
[INFO:2021-01-09 14:46:55] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:48:45]   Done loading.
[INFO:2021-01-09 14:48:46] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:50:36]   Done loading.
[INFO:2021-01-09 14:50:37] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:52:27]   Done loading.
[INFO:2021-01-09 14:52:28] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:54:18]   Done loading.
[INFO:2021-01-09 14:54:18] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:56:09]   Done loading.
[INFO:2021-01-09 14:56:10] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:58:00]   Done loading.
[INFO:2021-01-09 14:58:02] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 14:59:52]   Done loading.
[INFO:2021-01-09 14:59:54] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:01:43]   Done loading.
[INFO:2021-01-09 15:01:45] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:03:35]   Done loading.
[INFO:2021-01-09 15:03:35] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:05:26]   Done loading.
[INFO:2021-01-09 15:05:27] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:07:17]   Done loading.
[INFO:2021-01-09 15:07:18] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:09:08]   Done loading.
[INFO:2021-01-09 15:09:08] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:10:59]   Done loading.
[INFO:2021-01-09 15:11:00] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:12:49]   Done loading.
[INFO:2021-01-09 15:12:50] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:14:41]   Done loading.
[INFO:2021-01-09 15:14:41] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:16:32]   Done loading.
[INFO:2021-01-09 15:16:33] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:18:23]   Done loading.
[INFO:2021-01-09 15:18:24] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:20:14]   Done loading.
[INFO:2021-01-09 15:20:15] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:22:05]   Done loading.
[INFO:2021-01-09 15:22:06] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:23:55]   Done loading.
[INFO:2021-01-09 15:23:56] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:25:45]   Done loading.
[INFO:2021-01-09 15:25:45] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:27:35]   Done loading.
[INFO:2021-01-09 15:27:36] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:29:26]   Done loading.
[INFO:2021-01-09 15:29:27] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:31:17]   Done loading.
[INFO:2021-01-09 15:31:17] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:33:07]   Done loading.
[INFO:2021-01-09 15:33:08] Loading Dataset: MLRSNet (train); Processing 24964 labels
[INFO:2021-01-09 15:34:58]   Done loading.
[INFO:2021-01-09 15:34:58] Training for 200 epochs.
